# ğŸ“ æ™ºæ…§æ•™å®¤ç®¡ç†ç³»çµ±

> æ•´åˆ Microsoft Immersive Readerã€Azure AI å’Œ Firebase çš„ç¾ä»£åŒ–å­¸ç¿’å¹³å°

[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![Firebase](https://img.shields.io/badge/Firebase-9+-orange.svg)](https://firebase.google.com/)
[![Azure](https://img.shields.io/badge/Azure-AI-blue.svg)](https://azure.microsoft.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## ğŸŒŸ åŠŸèƒ½ç‰¹è‰²

### ğŸ« æ™ºæ…§æ•™å®¤ç®¡ç†
- **é›™æ¨¡å¼å„²å­˜**ï¼šåŒ¿åç”¨æˆ¶ï¼ˆè¨˜æ†¶é«”24å°æ™‚ï¼‰+ èªè­‰ç”¨æˆ¶ï¼ˆFirebaseæ°¸ä¹…ï¼‰
- **å³æ™‚é€²åº¦è¿½è¹¤**ï¼šå­¸ç¿’æ™‚é–“ã€å–®å­—æŒæ¡åº¦ã€æ’è¡Œæ¦œ
- **æ•™å¸«æ§åˆ¶é¢æ¿**ï¼šèª²å ‚ç®¡ç†ã€å­¸ç”Ÿç›£æ§ã€çµ±è¨ˆåˆ†æ
- **å­¸ç”Ÿå­¸ç¿’ä»‹é¢**ï¼šå€‹äººé€²åº¦ã€äº’å‹•å­¸ç¿’ã€æˆå°±ç³»çµ±

### ğŸ¤– AI æ™ºæ…§åŠŸèƒ½
- **Azure Computer Vision**ï¼šOCRæ–‡å­—è­˜åˆ¥ã€åœ–åƒåˆ†æ
- **Microsoft Immersive Reader**ï¼šæ²‰æµ¸å¼é–±è®€é«”é©—
- **æ™ºæ…§è©å½™æå–**ï¼šå¤šæ ¼å¼æ–‡ä»¶è™•ç†ã€è‡ªå‹•åˆ†è©
- **å¤šèªè¨€æ”¯æ´**ï¼šç‰¹åˆ¥å„ªåŒ–ç¹é«”ä¸­æ–‡

### ğŸ” å®‰å…¨æ€§è¨­è¨ˆ
- **Firebase Authentication**ï¼šOAuth 2.0 èªè­‰
- **Firestore Security Rules**ï¼šè³‡æ–™å­˜å–æ§åˆ¶
- **è¼¸å…¥é©—è­‰**ï¼šé˜²æ­¢ XSS å’Œæ³¨å…¥æ”»æ“Š
- **ç’°å¢ƒè®Šæ•¸ç®¡ç†**ï¼šæ•æ„Ÿè³‡æ–™ä¿è­·

### ğŸ‘¶ å°å­¸ç”Ÿè‹±æ–‡å­¸ç¿’åœ–ç‰‡ç”Ÿæˆå™¨ (Kids Vocabulary Generator)
å°ˆç‚ºå…’ç«¥è¨­è¨ˆçš„ç”Ÿæˆå¼ AI åŠŸèƒ½ï¼Œå…·å‚™å¤šé‡å®‰å…¨é˜²è­·ï¼š
1.  **Pollinations API å®‰å…¨æ¨¡å¼**ï¼šå¼·åˆ¶å•Ÿç”¨ `&safe=true` åƒæ•¸ï¼Œéæ¿¾ NSFW å…§å®¹ã€‚
2.  **è² é¢æç¤ºè©é˜²è­·**ï¼šè‡ªå‹•æ³¨å…¥ `no violence, no nudity` ç­‰è² é¢é—œéµå­—ï¼Œé›™é‡ä¿éšªã€‚
3.  **æ­£å‘å¼•å°**ï¼šå¼·åˆ¶ä½¿ç”¨ `cartoon, for children` é¢¨æ ¼ï¼Œé¿å…ç”Ÿæˆéæ–¼å¯«å¯¦æˆ–é©šæ‚šçš„åœ–ç‰‡ã€‚
4.  **è¼¸å…¥å„ªåŒ–**ï¼šé–‹æ”¾æ•¸å­—è¼¸å…¥ (`3 little pigs`)ï¼Œä¸¦å…·å‚™ç€è¦½å™¨å±¤ç´šæ‹¼å­—æª¢æŸ¥èˆ‡é˜²å‘†æ©Ÿåˆ¶ã€‚
5.  **æ‰‹æ©Ÿç‰ˆé¢å„ªåŒ–**ï¼šå–®é å¼(One-screen)ç·Šæ¹Šè¨­è¨ˆï¼Œå°‡åœ–ç‰‡èˆ‡è¼¸å…¥æ¡†æ•´åˆæ–¼åŒä¸€ç•«é¢ï¼Œä¸¦ä½¿ç”¨æ‡¸æµ®æŒ‰éˆ•æœ€å¤§åŒ–è¦–è¦ºç©ºé–“ã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å‰ç½®éœ€æ±‚
- Node.js 18+
- npm æˆ– yarn
- Firebase å°ˆæ¡ˆï¼ˆé¸ç”¨ï¼‰
- Azure Computer Vision æœå‹™ï¼ˆé¸ç”¨ï¼‰

### åŸºç¤å®‰è£ï¼ˆè¨˜æ†¶é«”æ¨¡å¼ï¼‰
```bash
# 1. å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/ä½ çš„ç”¨æˆ¶å/immersive-viewer-enhanced.git
cd immersive-viewer-enhanced

# 2. å®‰è£ä¾è³´
npm install

# 3. å•Ÿå‹•æœå‹™
npm start

# 4. é–‹å•Ÿç€è¦½å™¨
# http://localhost:3000
```

### å®Œæ•´å®‰è£ï¼ˆé›²ç«¯æ¨¡å¼ï¼‰

#### 1. è¨­å®š Firebase
```bash
# å»ºç«‹ Firebase å°ˆæ¡ˆ
# 1. åˆ° https://console.firebase.google.com/
# 2. å»ºç«‹æ–°å°ˆæ¡ˆ
# 3. å•Ÿç”¨ Authentication å’Œ Firestore
# 4. ä¸‹è¼‰æœå‹™å¸³æˆ¶é‡‘é‘°
```

#### 2. è¨­å®š Azure Computer Vision
```bash
# 1. åˆ° https://portal.azure.com/
# 2. å»ºç«‹ Computer Vision è³‡æº
# 3. å–å¾— API Key å’Œ Endpoint
```

#### 3. é…ç½®ç’°å¢ƒè®Šæ•¸
```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp .env.example .env

# ç·¨è¼¯ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„æœå‹™é‡‘é‘°
```

#### 4. éƒ¨ç½² Firestore è¦å‰‡
```bash
# å®‰è£ Firebase CLI
npm install -g firebase-tools

# ç™»å…¥ Firebase
firebase login

# éƒ¨ç½²è¦å‰‡å’Œç´¢å¼•
firebase deploy --only firestore
```

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
immersive-viewer-enhanced/
â”œâ”€â”€ ğŸ“‚ src/
â”‚   â”œâ”€â”€ ğŸ“‚ config/           # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ firebase-admin.js    # Firebase Admin SDK
â”‚   â”‚   â””â”€â”€ multer-config.js     # æ–‡ä»¶ä¸Šå‚³é…ç½®
â”‚   â”œâ”€â”€ ğŸ“‚ middleware/       # ä¸­ä»‹è»Ÿé«”
â”‚   â”‚   â””â”€â”€ auth-middleware.js   # èªè­‰ä¸­ä»‹è»Ÿé«”
â”‚   â”œâ”€â”€ ğŸ“‚ services/         # æœå‹™å±¤
â”‚   â”‚   â”œâ”€â”€ classroom-manager.js      # æ•™å®¤ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ firestore-classroom-service.js  # Firestore æœå‹™
â”‚   â”‚   â””â”€â”€ azureVision.js            # Azure AI æœå‹™
â”‚   â””â”€â”€ ğŸ“‚ utils/            # å·¥å…·å‡½æ•¸
â”œâ”€â”€ ğŸ“‚ routes/               # API è·¯ç”±
â”œâ”€â”€ ğŸ“‚ views/                # é é¢æ¨¡æ¿
â”œâ”€â”€ ğŸ“‚ public/               # éœæ…‹è³‡æº
â”‚   â””â”€â”€ ğŸ“‚ js/               # å‰ç«¯ JavaScript
â””â”€â”€ ğŸ“‚ docs/                 # æ–‡æª”
```

## ğŸ¯ ä½¿ç”¨å ´æ™¯

### ğŸ‘¨â€ğŸ« æ•™å¸«ä½¿ç”¨æµç¨‹
1. **å»ºç«‹èª²å ‚**ï¼šä¸Šå‚³è©å½™æ–‡ä»¶ï¼Œç”Ÿæˆèª²å ‚ä»£ç¢¼
2. **åˆ†äº«ä»£ç¢¼**ï¼šå­¸ç”Ÿä½¿ç”¨4ä½ä»£ç¢¼åŠ å…¥èª²å ‚
3. **ç›£æ§é€²åº¦**ï¼šå³æ™‚æŸ¥çœ‹å­¸ç¿’çµ±è¨ˆå’Œæ’è¡Œæ¦œ
4. **ç®¡ç†èª²å ‚**ï¼šæŸ¥çœ‹è©³ç´°é€²åº¦ã€åŒ¯å‡ºå ±å‘Š

### ğŸ‘¨â€ğŸ“ å­¸ç”Ÿä½¿ç”¨æµç¨‹
1. **åŠ å…¥èª²å ‚**ï¼šè¼¸å…¥èª²å ‚ä»£ç¢¼å’Œå§“å
2. **é–‹å§‹å­¸ç¿’**ï¼šä½¿ç”¨ Immersive Reader å­¸ç¿’è©å½™
3. **è¿½è¹¤é€²åº¦**ï¼šæŸ¥çœ‹å€‹äººçµ±è¨ˆå’Œç­ç´šæ’å
4. **äº’å‹•åŠŸèƒ½**ï¼šå–®å­—äº¤æ›ã€ç·´ç¿’è¨˜éŒ„

## ğŸ”§ API æ–‡æª”

### æ•™å®¤ç®¡ç† API
```javascript
// å»ºç«‹èª²å ‚
POST /classroom/create
Content-Type: multipart/form-data
Authorization: Bearer <token> (optional)

// åŠ å…¥èª²å ‚
POST /classroom/join
{
  "code": "ABC1",
  "studentName": "å°æ˜"
}

// é–‹å§‹å­¸ç¿’æœƒè©±
POST /classroom/api/session/start
{
  "code": "ABC1",
  "studentName": "å°æ˜"
}
```

### èªè­‰ API
```javascript
// æˆ‘çš„èª²å ‚ï¼ˆéœ€è¦èªè­‰ï¼‰
GET /classroom/api/my-classrooms
Authorization: Bearer <token>

// å­¸ç¿’é€²åº¦ï¼ˆéœ€è¦èªè­‰ï¼‰
GET /classroom/api/progress/:classroomId
Authorization: Bearer <token>
```

## ğŸ“Š è³‡æ–™åº«è¨­è¨ˆ

### Firestore é›†åˆçµæ§‹
```javascript
// classrooms é›†åˆ
{
  code: "ABC1",
  name: "è‹±æ–‡èª²",
  words: ["apple", "banana"],
  ownerId: "firebase-uid",
  createdAt: Timestamp
}

// classrooms/{id}/students å­é›†åˆ
{
  name: "å°æ˜",
  totalTime: 3600,
  wordStats: {
    "apple": { correct: 5, wrong: 2 }
  }
}
```

## ğŸ›¡ï¸ å®‰å…¨æ€§

### Firestore Security Rules
```javascript
// åªæœ‰èª²å ‚æ“æœ‰è€…å¯ä»¥è®€å–ç§äººèª²å ‚
match /classrooms/{classroomId} {
  allow read: if resource.data.isPublic == true 
    || request.auth.uid == resource.data.ownerId;
  allow create: if request.auth != null 
    && request.auth.uid == request.resource.data.ownerId;
}
```

### ç’°å¢ƒè®Šæ•¸å®‰å…¨
- æ‰€æœ‰æ•æ„Ÿè³‡æ–™å­˜æ”¾åœ¨ `.env` æ–‡ä»¶
- `.env` å·²åŠ å…¥ `.gitignore`
- ç”Ÿç”¢ç’°å¢ƒä½¿ç”¨å¹³å°ç’°å¢ƒè®Šæ•¸

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½²
```bash
# 1. å®‰è£ Vercel CLI
npm i -g vercel

# 2. éƒ¨ç½²
vercel

# 3. è¨­å®šç’°å¢ƒè®Šæ•¸
vercel env add FIREBASE_SERVICE_ACCOUNT
```

### Railway éƒ¨ç½²
```bash
# 1. é€£æ¥ GitHub repository
# 2. åœ¨ Railway æ§åˆ¶å°è¨­å®šç’°å¢ƒè®Šæ•¸
# 3. è‡ªå‹•éƒ¨ç½²
```

## ğŸ§ª æ¸¬è©¦

```bash
# åŸ·è¡Œæ¸¬è©¦
npm test

# æ¸¬è©¦è¦†è“‹ç‡
npm run test:coverage

# ç«¯å°ç«¯æ¸¬è©¦
npm run test:e2e
```

## ğŸ“ˆ æ•ˆèƒ½å„ªåŒ–

- **Firestore ç´¢å¼•**ï¼šå„ªåŒ–æŸ¥è©¢æ•ˆèƒ½
- **CDN å¿«å–**ï¼šéœæ…‹è³‡æºåŠ é€Ÿ
- **åœ–ç‰‡å£“ç¸®**ï¼šæ¸›å°‘è¼‰å…¥æ™‚é–“
- **ä»£ç¢¼åˆ†å‰²**ï¼šæŒ‰éœ€è¼‰å…¥

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. é–‹å•Ÿ Pull Request

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Š - è©³è¦‹ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ™ è‡´è¬

- [Microsoft Immersive Reader](https://docs.microsoft.com/azure/applied-ai-services/immersive-reader/)
- [Azure Computer Vision](https://azure.microsoft.com/services/cognitive-services/computer-vision/)
- [Firebase](https://firebase.google.com/)
- [Express.js](https://expressjs.com/)

## ğŸ“ è¯çµ¡æ–¹å¼

- å°ˆæ¡ˆé€£çµï¼š[https://github.com/ä½ çš„ç”¨æˆ¶å/immersive-viewer-enhanced](https://github.com/ä½ çš„ç”¨æˆ¶å/immersive-viewer-enhanced)
- å•é¡Œå›å ±ï¼š[Issues](https://github.com/ä½ çš„ç”¨æˆ¶å/immersive-viewer-enhanced/issues)

---

â­ å¦‚æœé€™å€‹å°ˆæ¡ˆå°ä½ æœ‰å¹«åŠ©ï¼Œè«‹çµ¦å€‹æ˜Ÿæ˜Ÿæ”¯æŒï¼

---

## ğŸ“¦ GitHub åœ–åº«éƒ¨ç½²èˆ‡è¨­å®š (Kids Vocabulary)

ç‚ºäº†è®“ã€Œå°å­¸ç”Ÿå–®å­—ç”Ÿæˆå™¨ã€èƒ½å¤ æ°¸ä¹…å„²å­˜åœ–ç‰‡ä¸¦ç¯€çœç”Ÿæˆæˆæœ¬ï¼Œæœ¬å°ˆæ¡ˆæ•´åˆäº† **GitHub Repository + GitHub Pages** ä½œç‚ºå…è²»åœ–åº«ã€‚è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿè¨­å®šï¼š

### 1. æº–å‚™ GitHub Repository
æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬å°ˆæ¡ˆçš„ Repoï¼Œæˆ–æ˜¯å»ºç«‹ä¸€å€‹å…¨æ–°çš„ Repo (ä¾‹å¦‚ `vocabulary-images`) ä¾†å°ˆé–€å­˜åœ–ã€‚

### 2. ç”³è«‹ Personal Access Token (PAT)
ç”±æ–¼å¾Œç«¯éœ€è¦ä¸Šå‚³åœ–ç‰‡ï¼Œå¿…é ˆæä¾›æ¬Šé™æ†‘è­‰ï¼š
1.  å‰å¾€ [GitHub Settings > Developer settings > Personal access tokens > Tokens (classic)](https://github.com/settings/tokens).
2.  é»æ“Š **Generate new token (classic)**ã€‚
3.  **Scopes** (æ¬Šé™) å‹™å¿…å‹¾é¸ï¼š
    *   `repo` (åŒ…å« `public_repo` ç­‰ï¼Œç”¨æ–¼ä¸Šå‚³æª”æ¡ˆ)ã€‚
4.  è¤‡è£½ç”¢ç”Ÿçš„ Token (é–‹é ­é€šå¸¸æ˜¯ `ghp_...`)ã€‚

### 3. è¨­å®šç’°å¢ƒè®Šæ•¸
åœ¨ `.env` æª”æ¡ˆä¸­åŠ å…¥ä»¥ä¸‹è¨­å®šï¼š
```env
GITHUB_TOKEN=ghp_ä½ çš„Token
GITHUB_OWNER=ä½ çš„GitHubå¸³è™Ÿ (è«‹å¡« Usernameï¼Œå‹¿å¡« Email)
GITHUB_REPO=ä½ çš„Repoåç¨± (ä¾‹å¦‚ immersive-viewer-antigrovity)
GITHUB_PATH=public/library  # åœ–ç‰‡å­˜æ”¾è·¯å¾‘ (é è¨­å»ºè­°)
```
> âš ï¸ **å®‰å…¨æ€§æé†’**ï¼š`GITHUB_TOKEN` åªèƒ½æ”¾åœ¨å¾Œç«¯ä¼ºæœå™¨çš„ç’°å¢ƒè®Šæ•¸ä¸­ï¼Œ**çµ•å°ä¸è¦** æš´éœ²åœ¨å‰ç«¯ç¨‹å¼ç¢¼æˆ– `.env.example` ä¸­ã€‚

### 4. å•Ÿç”¨ GitHub Pages (é—œéµæ­¥é©Ÿ)
ç‚ºäº†è®“å‰ç«¯èƒ½é€é CDN å¿«é€Ÿè®€å–åœ–ç‰‡ï¼Œå¿…é ˆé–‹å•Ÿ Pages åŠŸèƒ½ï¼š
1.  é€²å…¥ Repo çš„ **Settings** é é¢ã€‚
2.  å·¦å´é¸å–®é»æ“Š **Pages**ã€‚
3.  **Build and deployment > Source** é¸æ“‡ `Deploy from a branch`ã€‚
4.  **Branch** é¸æ“‡ `main` (æˆ– master)ï¼Œè³‡æ–™å¤¾é¸æ“‡ `/ (root)`ã€‚
5.  é»æ“Š **Save**ã€‚

### âœ… é©—è­‰æ–¹å¼
å®Œæˆå¾Œï¼Œç•¶æ‚¨åœ¨ç¶²ç«™ä¸Šç”Ÿæˆä¸€å€‹æ–°å–®å­— (ä¾‹å¦‚ "apple")ï¼š
1.  ç³»çµ±æœƒè‡ªå‹•å°‡åœ–ç‰‡ä¸Šå‚³åˆ° Repo çš„ `public/library/` è³‡æ–™å¤¾ã€‚
2.  ç­‰å¾…ç´„ 1-2 åˆ†é˜ (GitHub Pages éƒ¨ç½²æ™‚é–“)ã€‚
3.  ä¸‹æ¬¡å…¶ä»–äººè¼¸å…¥ "apple" æ™‚ï¼Œç³»çµ±æœƒæœ‰ 100% çš„é€Ÿåº¦å„ªå‹¢ï¼Œç›´æ¥å¾ `https://{å¸³è™Ÿ}.github.io/{Repo}/public/library/{hash}.jpg` è®€å–åœ–ç‰‡ï¼Œé€Ÿåº¦æ¥µå¿«ä¸”ä¸æ¶ˆè€— AI é¡åº¦ï¼